{
    "abstract_text": "In this Supplementary Information, a stochastic model of COVID-19 transmission in a homogeneous population is presented and analysed. Disease progression of an individual is compartmentalised into latent (L), pre-symptomatic infectious (A) and symptomatic (S) phases. To better accommodate the transmission characteristics of COVID-19 at the population level, the A phase is further split into two sub-periods, A 1 before the infectiousness peak with a variable duration, and A 2 after the infectiousness peak with a fixed duration. With regard to the transmission capacity, the A 2 phase and the S phase are treated as a single stretch of declining infectiousness. For a sufficiently large population, the size of infected subpopulations satisfies an integral renewal equation. We derive the kernel function from the model and calibrate it against clinical case studies. Analytical and numerical solutions of the integral equation with and without intervention are presented.From a mathematical point of view, our model can be considered as a special case of the general class of epidemic models originally introduced by Kermack and McKendrick [1] and expanded over the years. For a historical review and modern treatment, we refer the reader to Refs. [2, 3, 4] . We would like to thank the anonymous reviewers for bringing these classical works to our attention",
    "body_text": "In this Supplementary Information, a stochastic model of COVID-19 transmission in a homogeneous population is presented and analysed. Disease progression of an individual is compartmentalised into latent (L), pre-symptomatic infectious (A) and symptomatic (S) phases. To better accommodate the transmission characteristics of COVID-19 at the population level, the A phase is further split into two sub-periods, A 1 before the infectiousness peak with a variable duration, and A 2 after the infectiousness peak with a fixed duration. With regard to the transmission capacity, the A 2 phase and the S phase are treated as a single stretch of declining infectiousness. For a sufficiently large population, the size of infected subpopulations satisfies an integral renewal equation. We derive the kernel function from the model and calibrate it against clinical case studies. Analytical and numerical solutions of the integral equation with and without intervention are presented.From a mathematical point of view, our model can be considered as a special case of the general class of epidemic models originally introduced by Kermack and McKendrick [1] and expanded over the years. For a historical review and modern treatment, we refer the reader to Refs. [2, 3, 4] . We would like to thank the anonymous reviewers for bringing these classical works to our attention. The basic structure of our model follows Main Text Figure 1 , with model parameters defined in Supplementary Figure 1 . The disease progression parameters \u03b1 A and \u03b1 L (t L ) are taken to be universal, while the transmission rates \u03b2 A and \u03b2 B (t B ) may vary significantly from community to community.Supplementary Figure 1 : A stochastic model for disease progression and transmission. Disease progression of an infected individual is assumed to be described by a renewal process following the sequence of latent (L), pre-symptomatic infectious (A 1 and A 2 ) and symptomatic (S) phases. The transition rate from L to A 1 is given by \u03b1 L (t L ) which depends on the dwell time t L in the latent phase. The transition from A 1 to A 2 , which coincides with peak infectiousness, is Poisson at a constant rate \u03b1 A . The A 2 phase has a fixed duration \u03b8 P , after which the patient enters S phase. All three phases A 1 , A 2 and S are infectious, with transmission rates to reproduce secondary cases given by \u03b2 A (A 1 phase) and \u03b2 B (t B ) (A 2 and S phases combined), respectively. The latter is a function of t B , the number of days since the start of the A 2 phase.We now consider groups of infected individuals in L, A 1 , A 2 and S in a large and well-mixed population, using italic symbols to denote their size. We shall also assume that the number of individuals in each of the disease phases is sufficiently large, so that stochasticity arising from the random transition events to enter the next phase is averaged out, leading to deterministic equations at the population level. Our experience with numerical simulations of the stochastic model indicates that ten is already a good size for the subpopulations for this purpose. Unless otherwise specified, we will use the capital letter T to denote calendar time, and the lower case letters t, t A , t B to denote elapsed times since infection and upon entering the A 1 and A 2 phases, respectively.In a closed community, the number of new infections per unit time (also known as \"incidence\") at time T is given by,(S1)The first term is due to transmission by infected individuals in the A 1 phase. The second term is due to individuals who have transited to the post A 1 phase at an earlier time T \u2212 t B . Each newly infected individual then follows the disease progression path shown by the blue arrows in Supplementary Figure 1 , with the transition rates as specified. In particular, the mean flux to A 1 at time T due to a group infected in the time interval (T \u2212 t, T \u2212 t + dt) is given by,is the probability that an individual remains in the latent phase L on day t since infection. Adding up contributions from all such groups, we obtainGiven that the exit rate from the A 1 phase is given by \u03b1 A , we may write,The last line is obtained with the help of the identity,Equations (S1) and (S3) allow us to obtain the following closed equation,Hereis the mean reproduction rate of a viral carrier in day t since infection. The first term on the right-hand side of (S6) is quite obvious. To obtain the second term, we write the term inside the square brackets of Eq. (S3) as,where we have used Eq. (S4) for the last step. Furthermore,as required.Equation (S5) implies that the temporal evolution of any linear function of J L in the formsatisfies the renewal equationThis can be shown easily as follows:Equations (S5) and (S7), with the kernel function r(t) given by (S6), constitute the fundamental dynamical equations for epidemic development at the population level. To include imported cases at the beginning or during an outbreak, a source term should be added to Eq. (S5), as we illustrate in Sec. 4.5.The symptom onset separates the A 2 phase from the S phase. In our model, the A 2 phase is assigned a fixed duration \u03b8 P , the time lag between the peak infectiousness and the symptom onset. Consequently, we may express the symptom onset time as,where t L and t A1 are the times an infected person spent in the latent and A 1 phases, respectively. Since the statistics of t A1 follows a Markov process with a time constant 1/\u03b1 A in our model, one may infer the statistics of t L from the statistics of t O . This then allows us to determine the kernel function r(t) and other quantities of interest in terms of the symptom onset time distribution p O (t), which can be estimated from clinical data (see the section below). The function p O (t) is also known as the incubation period distribution. We use the two terms interchangeably both in SI and in the Main Text.In Supplementary Table 1 we give the probabilities for an individual to be in one of the four phases on day t since infection. Expressions in the last two rows are quite obvious. The transition probability current from A 1 to A 2 at time t is given by \u03b1 A q A 1 (t), which is the same as the probability density for symptom onset at a later time t + \u03b8 P . This gives the expression for q A 1 (t) in Supplementary Table 1 . The expression for q L (t) is obtained simply by requiring that the sum of the probabilities is equal to one.From the expression for q L (t) in Supplementary Table 1 , we obtain its Laplace transform,where we have set p O (t) = 0 for t < \u03b8 P . The Laplace transform of \u03b1 L (t)q L (t) = \u2212q L (t) is given by 1 \u2212 \u03bbq L (\u03bb). Noting that Eq. (S6) is in the form of a convolution integral, we obtain, The self-sustained growth rate \u03bb of an epidemic can be obtained by seeking a solution X(T ) = e \u03bb(T \u2212T 0 ) to Eq. (S7). Simple algebra givesrIn the epidemiological literature, it is customary to express the growth rate \u03bb in terms of the mean reproduction numberwhere we have used Eq. (S9). The first term on the right-hand-side gives the contribution to R E from the pre-symptomatic A 1 phase, and the second term from the rest. Alternatively, noting that\u03b2being the mean reproduction numbers in the pre-symptomatic and symptomatic phases, respectively. Dividing both sides of (S10) by R E and making use of Eqs. (S9) and (S11), we obtain upon inversion,At \u03bb = 0, R E = 1, as required, independent of the model parameters. Equation (S12) defines the fundamental relation between the mean reproduction number of infected individuals and the growth rate of the epidemic. The distribution p O (t) plays an essential role in this relation. One immediate result from Eq. (S12) is that R E = 0 is at the pole ofp O (\u03bb). For an exponentially decaying p O (t) \u223c e \u2212\u03bbt at large t, the pole is at \u03bb = \u2212\u03bb O , which yields the rate of decay when transmission stops completely.Wallinga and Lipsitch [5] proposed a general equation between R E and \u03bb based on the normalised \"generation interval distribution\",(S13)At the observed epidemic growth rate \u03bb, each individual produces R E (\u03bb) offspring. Consequently,gknown as the Lotka-Euler estimating equation. This equation is equivalent to (S12).Supplementary Table 2 : Percentage of the infected population in each of the disease phases when the epidemic grows at a rate \u03bb. Table 1 ,Latent L Q L (\u03bb) 1 \u2212 1 + \u03bb \u03b1 A e \u03bb\u03b8 Pp O (\u03bb) Pre-symptomatic Infectious A 1 Q A 1 (\u03bb) \u03bb \u03b1 A e \u03bb\u03b8 Pp O (\u03bb) Pre-symptomatic Infectious A 2 Q A 2 (\u03bb) e \u03bb\u03b8 P \u2212 1 p O (\u03bb) Symptomatic S Q S (\u03bb)p O (\u03bb)(S14)For easy reference, the percentages of subpopulations are collected in Supplementary Table 2.In this section, we present technical details on the estimation of model parameters from case studies reported in the literature. In line with our modelling framework, we first examine the statistics of the symptom onset time and perform a maximum likelihood analysis to determine a parametric representation of the data. We then determine the mean infectiousness of COVID-19 patients from the serial interval statistics collected during the early days of the epidemic in China. These analyses yield estimates for the transmission parameters introduced in the previous section.The incubation periods of individual patients before symptom onset were summarised in three articles: 59 cases collected by Men et al. [6] , 105 cases collected by Xia et al. [7] , and 181 cases collected by Bi et al. [8] . In total, we examined N = 347 cases with their incubation periods. In most cases, the infection date can only be assigned to a time interval of more than one day. Therefore, the actual incubation period falls between IPl i and IPu i , i = 1, ..., N , where IPl i and IPu i set the lower and upper bounds for the incubation period of case i, respectively. The raw statistics of the three datasets is shown in Main Text Figure 2a . This is done by simply assign equal weight to the possible values within the reported window [IPl i , IPu i ] for each of the patients. The nominal probability distribution of the incubation period from each dataset (or the aggregated one) is then obtained by taking a simple average over all the cases within the set. Although there is general consistency with regard to the overall shape of the distributions obtained, there are also significant deviations particularly outside the peak region. While part of the variations can be attributed to statistical fluctuations when the sample size is limited, it is also plausible that systematic bias exists under the equal probability assumption when dealing with uncertainties related to finite exposure windows.Below we perform a more refined analysis, i.e., maximum likelihood estimation, of the underlying symptom onset time distribution p O (\u03b8, t), with \u03b8 being the parameter set. Following the scheme proposed by Reich et al. [9] , we consider the following likelihood function,Eyeballing the data in Main Text Figure 2a , we hypothesise the tail of the distribution to be an exponential function. This motivates us to consider the following two hybrid functional forms for p O (\u03b8, t) and perform the maximum likelihood estimation.The log-normal distribution is commonly used for the incubation period in the epidemiological literature. We connect it to a simple exponential decay at t e :(S16)Here the log-normal probability density function (PDF) p ln (t) is parametrised by \u00b5 and \u03c3:where erf(x) is the Gauss error function. Continuity of the derivatives at t e demands.(S19) Therefore, we have in total three independent parameters \u03b8 = (t e , \u00b5, \u03c3) in the above model. Through numerically optimising the likelihood function with the Nelder-Mead simplex algorithm, we obtained the optimal parameter sets for different t e , which is shown in Supplementary  Table 3 .Supplementary Table 3 : Maximum likelihood estimation of parameters in Eq. (S16). Results are from bootstrap re-sampling of the data described in the text, with 1000 realisations (95% confidence interval shown in parentheses). The maximal likelihood is achieved at t e = 6. It should be noted that the exponent \u03b3 is quite stable around 0.31/day. The bottom row gives results for the full log-normal distribution (t e = \u221e), which has a smaller likelihood value than the hybrid one at t e = 6.For the second class of functions, we use the Weibull distribution to connect with an exponential tail:(S20)Here the Weibull PDF p wb (t) is parametrised by k (shape parameter) and \u03bb (scale parameter):The normalisation factor isContinuity of derivatives at t e yieldsThis model has three independent parameters \u03b8 = (t e , k, \u03bb). We numerically optimised the likelihood function through the Nelder-Mead simplex algorithm at different t e , with results given in Supplementary Table 4 .Supplementary Table 4 : Maximum likelihood estimation of parameters in Eq. (S20). Results are from bootstrap re-sampling of the data described in the text, with 1000 realisations (95% confidence interval shown in parentheses). The maximal likelihood is achieved at t e = 4. The likelihood for t e = \u221e is lower which suggests that our hybrid function is more faithful to the data than the full Weibull distribution.The estimated value for \u03b3 here is very similar to the result presented in Supplementary Table  3 . However, the optimal likelihood obtained under the hybrid Weibull distribution is quite a bit less than that of the hybrid log-normal distribution. Therefore, we adopt the log-normal distribution with an exponential tail as the best estimate for p O (t) and use it in our numerical calculations.Confidence intervals given in Supplementary Tables 3 and 4 are obtained following a bootstrap scheme [9] . This is done by generating 1000 re-sampled copies of the initial 347 cases dataset. The maximum likelihood estimation is then performed for each of the re-sampled copy. Records of disease transmission by individual patients through the course of their disease progression are scarce in the public domain. We therefore estimated the transmission parameters defined in Supplementary Figure 1 indirectly using the reported infector-infectee pairs. Such a procedure is subject to bias arising from the data collection process. For example, intra-family transmission tends to be over-represented [10, 11] . Keeping potential shortcomings of this type in mind, we present below quantification of our model using the data provided by He et al. [12] The dataset contains 74 infector-infectee pairs. Among them, 66 pairs have a unique symptom onset date (see Source Data). They are used in our analysis. As illustrated in Supplementary Figure Below, we quantify the statistics of disease transmission time with a probability density function p I (\u03b8, t), with t measured from the symptom onset of the infector, and \u03b8 the set of parameters to be determined. Then maximum likelihood estimation is applied to fit the discrete exposure window data [9] . The likelihood function is given by:Given the limited resolution for the exposure window in integral values, we shall limit ourselves to the following parametrisation of p I (\u03b8, t): a conglomerate of two exponential wings and its extensions with either a flat or a smooth cap. We consider each of them separately.We first consider the case of two exponential functions joined directly at \u03b8 P :This model has three independent parameters \u03b8 = (\u03b1 A , \u03b1 B , \u03b8 P ). The normalisation factor A is simplyBy numerically optimising the likelihood function through the Nelder-Mead simplex algorithm, we obtained the optimal parameter set shown in Supplementary Table 5 . Expanding the peak of the function defined by (S25) into a flat cap of size , we have,Here,The normalisation factor is simplyThis model has four independent parameters \u03b8 = (\u03b1 A , \u03b1 B , \u03b8 P , ). Through numerical optimisation of the likelihood functions at different values of , we obtained the optimal parameter sets, which are shown in Supplementary Table 6 . It can be seen from the above table that the likelihood increases with decreasing cap width , reaching its maximum at = 0 which is treated above.We now consider the case of a smooth cap as defined by:The shape of the quadratic function in the middle is parametrised by \u03c7, with its peak located at \u03b8 P . The normalisation factor is.(S31) Smoothness requires continuity of derivatives at \u03b8 P1 and \u03b8 P2 , respectively, which yields:Therefore, there are four independent parameters \u03b8 = (\u03b1 A , \u03b1 B , \u03b8 P , \u03c7). Note that in the limit of \u03c7 \u2192 \u221e this model reduces to the first model with two exponential functions joining at \u03b8 P . We numerically optimised the likelihood functions through the Nelder-Mead simplex algorithm at different \u03c7. Optimal parameter sets in each case are shown in Supplementary Table 7 . Note that the likelihood increases with increasing \u03c7, which indicates that the optimal estimation is achieved at vanishing cap size.In Main Text Figure 2b , we show the infectiousness curves obtained from the first model, the second model at = 1.0, and the third model at \u03c7 = 1.0.We performed bootstrap analysis to determine uncertainties in the estimated p I (t). This is done by generating 1000 re-sampled copies of the exposure window dataset of 66 transmission pairs. The maximum likelihood estimation for p I (t) is then performed for each of the re-sampled copy. The p I (t) for each of the re-sampled copied are shown as the grey lines in Main Text Figure  2b (for the conglomerate of two exponentials). The 95% confidence intervals for the estimated parameters are shown in Supplementary Table 5 and the Main Text Table I Du et al. [10] , Xu et al. [11] , and He et al. [12] reported the statistics of the serial intervals of infector-infectee pairs in 468, 679, and 66 confirmed serial infection cases, respectively, which we use to compare against the symptom onset distribution function as well as the infectiousness function obtained above.In a pairwise transmission event i \u2192 j, the serial interval t SI is the sum of the time of transmission \u2206t with respect to the symptom onset of the index patient i, and the symptom onset time t O,j of the infectee j, as illustrated in Supplementary Figure 2 . Assuming statistical independence between the latter two in the clinical samples collected, we may write the serial interval distribution as a convolutional integral, Table I in the Main Text. As noted in earlier studies [11, 13] , the empirical serial interval distributions can be skewed by shifts in the transmission window of the index patients surveyed. For example, travel delays move the effective p I (\u2206t) in the positive direction, while isolation of symptomatic patients move the effective p I (\u2206t) in the negative direction. In each case, p SI (t SI ) shifts correspondingly in the same direction.With the symptom onset time distribution p O (t) and the parameters \u03b1 A and \u03b8 P estimated from clinical and transmission case studies, we may proceed to compute the probabilities for an infected person to be in each of the disease phases on day t since infection. This can be done by numerically evaluating the expressions presented in Supplementary Table 1. Supplementary Figure 3 shows the probability q L (t) for the latent phase and the corresponding exit rate \u03b1 L (t). Good agreement is seen for q L (t) under the two parametrisation schemes adopted. The curves for \u03b1 L (t) = \u2212q L (t)/q L (t) also exhibit the same trend, although discrepancies exist in the actual shape. On the first day since infection, the transition rate to the infectious phase is low which explains the low value of \u03b1 L (t) in this period. This is followed by an accelerated transition rate and a faster than exponential decay of q L (t), reaching a peak value of 0.6 day \u22121 or above. After that the transition rate decelerates and reaches a plateau value of approximately 0.3 day \u22121 on the fifth day onward. Given that both \u03b1 A and \u03b1 B as given in Supplementary Table 5 In Sec. 1 we expressed various quantities in terms of the Laplace transform of p O (t). Here we consider simplifying approximations, which allow for more direct relations to be derived.As an explicit example, we consider disease transmission in a homogeneous population following the infectiousness curve shown in Main Text Figure 2b . The peak infectiousness happens at \u03b8 P = \u22120.68 days before the symptom onset, yielding \u03b8 P = 0.68 days. The left and right wings are well fitted to exponential functions with decay rates \u03b1 A 0.43 day \u22121 and \u03b1 B 0.54 day \u22121 , respectively. For the right wing, we may writewhere t B is measured from the beginning of the A 2 phase, e.g., \u03b8 P days before the symptom onset. The mean infectiousness curve on the left also matches well with the exponential distribution of the duration of the A 1 phase in the model introduced in Sec. 1, with a decay rate \u03b1 A . From Eq. (S34), we obtain the Laplace transform,Substituting Eq. (S35) into (S9), we obtain,For \u03bb \u03b1 B , we may approximateIntroducingwe may then write,rThis yields a very simple expression for the reproduction rate,with R E = (\u03b2 A /\u03b1 A ) + (\u03b2 A /\u03b1 B ). Equation (S13) then identifies p O (t + \u03b8 S ) with the generation time interval distribution g(t).A few remarks with regard to the re-parameterised model (S39) are in order. The parameter R E , which sets the overall scale of transmission, incorporates total contribution from both presymptomatic and symptomatic individuals (Main Text Figure 1 ). The shift parameter \u03b8 S , on the other hand, depends on how fast transmission decays on the symptomatic side. As seen from Eq. (S37), a small decay rate \u03b1 B may change \u03b8 S into the negative. Using the parameter values determined from Sec. 2, we obtain \u03b8 S \u22120.15 day. In this case, the peakshift of the infectiousness curve to the pre-symptomatic side is compensated by transmission from symptomatic patients. As reported in Ref. [13] , the latter could vary over time depending on the isolation measures applied to symptomatic patients.A number of modelling studies in the literature adopt a Markovian setup with \u03b1 L (t) = const. which is a special case of our more general non-Markovian approach (see, e.g., Ref. [4] ). Skipping the A 2 phase by setting \u03b8 P = 0, we have,The onset time distribution in this case is given bywith its mean and variance given by,Substituting Eq. (S40) into Eq. (S9), we obtain the Laplace transform of the kernel function,Below we consider a situation where \u03b2 B (t B ) decays to zero rapidly, i.e., the symptomatic transmission is much reduced. The second factor on the right-hand side of Eq. (S42) can then be approximated as,where R E is given by Eq. (S11) and \u03b1 A,eff = \u03b1 A [1 + \u03b1 A\u03b2 B (0)/R E ], with\u03b2 B (0) being the derivative of\u03b2 B (\u03bb) at \u03bb = 0. It follows thatThe inverse transform of the above expression yieldsUnder the effective kernel function (S43), Eq. (S10) takes the form,i.e., a parabola with two nodes at \u03bb L \u2212\u03b1 L and \u03bb A \u2212\u03b1 A,eff .In this section, we consider the effects of various intervention and containment measures aimed at a significant reduction of the mean reproduction number R E from its nominal number of 3 or above in an unprotected population, within the framework of the model described in Sec. 1. When these measures are implemented in combination, reductions multiply. Some of these measures, such as social distancing and wearing face masks, are aiming at an overall reduction of COVID-19 transmission in the population, while others are targeting more specifically at breaking down the transmission chain. Considering the difficulty in achieving a three-fold reduction of R E under any single measure, one is left with no option other than adopting as many of these measures as circumstances allow.Quarantine of infected individuals cuts down disease transmission. Naturally, the biggest challenge is to identify such individuals and isolate them sufficiently to stop transmission. We consider several scenarios below.Let t be the time interval between infection and identification of a given infected individual.Supplementary Table 8 gives the mean reproduction number from day t onward. The result depends on which phase the patient is in. L & A 1 R E entering A 2 at t 1 < t \u2206R B (t \u2212 t 1 ) = \u221e t\u2212t 1 \u03b2 B (t 2 )dt 2Testing and quarantining of infected individuals is practiced in South Korea during the early stages of the pandemic with great intensity. In the simplest scenario, a suspected individual undergoes one time test of COVID-19 infection. It takes a day or so for the test result to come back. If it is positive, the person will be quarantined and hence removed from the active infected population. Oral nucleic acid test only reports cases with a sufficiently high viral load. Therefore the test needs to be done around the time of symptom onset. However, by then the person may have already infected other people. Within our probabilistic framework, the efficiency of this procedure can be assessed as follows.We assume that the test protocol is implemented in such a way that a person on day t since infection is tested at a rate \u03b7 testing (t), i.e., the probability that he/she is tested during the time interval (t, t + dt) is \u03b7 testing (t)dt, with \u221e 0 \u03b7 testing (t)dt \u2264 1. We shall also assume that the test result, which is returned after \u03c4 d days, will be positive only when the infected has already passed the latent phase on the day of testing. With the help of the results in Supplementary  Table 8 , we may write the reduction in the mean reproduction number R E at the population level,In the extreme case that all infected are tested on day t test of their infection, we have \u03b7 testing (t) = \u03b4(t \u2212 t test ). Under Eqs. (S34) and (S46), the relative reduction of R E is given by,(S47) According to the expression in Supplementary Table 1, q A 1 (t test ) is peaked one day before the peak of the symptom onset time distribution. Consequently, the maximum reduction is also achieved when t test is chosen to be around that day. For smaller t test , the chance of returning a positive test result is low, while for larger t test , the patient in question is likely to have already infected others by the time of the test.In contact tracing, a high percentage of close contacts of a newly confirmed viral carrier (primary case) are identified and quarantined soon after the contact took place, without testing. This procedure is more effective when performed sufficiently close to the contact date, as it also covers secondary cases that are still in the latent phase of their disease progression. For the secondary cases, their r(t) is truncated on the day they are located, while transmission to tertiary cases could happen before that time. At an overall success rate q c , we assume infectees are traced down within a time window t trace since infection. The reduction of R E is then given by,where we have used Eq. (S39). Expression for q S (t) is given in Supplementary Table 1 .Considering the dual-effects of mask-wearing in reducing both virus inhalation by susceptible individuals and exhalation by infectious individuals (including pre-symptomatic and asymptomatic groups), we calculated the reduction of transmission rate \u03b2 against mask efficacy and the percentage of the population wearing masks under a simplifying approximation. We assumed that there are COVID-19 positive (P) and negative (N) individuals. p m is the percentage of the population that wear masks: p mP for positive individuals and p mN for negative individuals. Here, e denotes the efficacy of masks measured by the percentage of virus trapped by the mask: from inhalation (e in , important for COVID-19 negative individuals) and exhalation (e ex , important for COVID-19 positive individuals). In the absence of masks, the rate of transmission by a positive individual contacting a negative individual is \u03b2.Therefore, the averaged chance of transmission is:Supplementary Table 9 : Four types of encounters between a positive and a negative individual and reduction of the transmission rate \u03b2.Prob. of contact type P wearing mask N wearing mask Chance of transmission p mP \u00b7 p mN Yes YesUnder the totally symmetric assumption e ex = e in = e, p mN = p mP = p m , the result becomes:Note that this equation can be applied separately to pre-symptomatic and symptomatic transmission, with their own p m . In the numerical examples presented below and in the Main Text, we used the same p m for both types of transmission. In the more general case, the reduction of \u03b2 can be calculated when contributions of the two types to the total are known.Supplementary Figure 4 : Estimation on the impact of mask-wearing on the transmission rate. a. Schematic representation on the dual-effects of masks in reducing \u03b2. b. Relationship between the factor multiplying \u03b2 (heatmap color) with the mask efficacy (x-axis) and the fraction of the population wearing masks (y-axis). Black lines show the contours for reducing \u03b2 to 0.75, 0.5, 0.27 of its original value.The above discussion shows, in a semi-quantitative way, that mask-wearing brings benefits to one-self if not infected but more importantly to others. Even with masks at a moderate efficacy of 50%, reduction of the transmission rate can be substantial when practiced by the whole population.Previous research on influenza suggested that surgical mask reduces 70% of the viral aerosol shedding [14] . Also, WHO suggested that respiratory droplets (> 5 \u223c 10 \u00b5m in diameter) and contacts are the primary routes for COVID-19 to transmit between people [15] . Surgical mask reduces more than 90% of droplets in this size range [16] . However, general public may not be able to fully comply with the usage guidance of surgical masks. Therefore, in generating results in the Main Text, we take a simpler assumption that the efficacy of surgical masks is at 50%.Regarding potential concerns on the effectiveness of mask-wearing in reducing the epidemics, we provided additional references and descriptions in the following.In the laboratory setting, there is evidence that masks are able to filter in the relevant droplet size range for COVID-19, as well as efficacy in blocking droplets and particles from the wearer in a range higher or near the efficacy of 50% [17, 18] . For seasonal coronaviruses, surgical masks for source control were effective at blocking coronavirus droplets of all sizes for every subject [19] . Personal protection is more challenging than source control, since the inhaling particles are smaller. According to World Health Organisation's \"Advice on the use of masks in the context of COVID-19\" [20] , the penetration for surgical masks is 50%-60% , which is the range we used in our simplified model.There are already several experimental measurements on the efficacy of different types of masks against coronavirus, both as source control [19, 21, 22] and personal protection equipment [20, 23, 24] . In summary, there is laboratory-based evidence that surgical or N95 masks have satisfying filtration capacity in the relevant droplet size range of coronavirus. The experimental reports are included in the references.Several recent modelling works focusing on the effect of population-wide mask-wearing converge to similar conclusions that masks of intermediate filtering efficacy exhibit aggregate effect at the population level. For example, in the work of Stutt et al. [25] , they found that with a policy that all individuals must wear a mask all of the time, a median effective COVID-19 R E of below 1 could be reached, even with mask effectiveness of 50% (for R E = 2.2) or mask effectiveness of 75% (for R E = 4). Similarly, models from Kai et al. [26] estimated that 80-90% masking would eventually eliminate the disease. Work from Fisman et al. [27] also showed similar results.We particularly considered the situation that the filtering efficacy of masks being relatively low, and asked whether masks with intermediate efficacy in personal protection (for example, only filtering 50% of viruses) can have an aggregate effect when applied on a populationwide scale. In Supplementary Figure 4 , masks with different filtering efficacy are considered. The results show that even masks only trapping 20% of the virus can bring a significant impact when generally adopted by the population. Also, in the model shown in http://www.zhiyuanlab.xyz/MASK 0906.html, more details related to the effect of populationwide mask-wearing were considered, such as infections relying on non-respiratory routes, and the different filtering efficacies for masks as source control and personal protection.Last but not least, via comparing cases in German regions with and without masks and weighing various estimates, Mitze et al. [28] concluded that 20 days after becoming mandatory face masks had reduced the number of new infections by around 45%, with economic costs close to zero compared to other public health measures.Border control measures can effectively stop imported cases of viral carriers. To examine the time needed for their effect to take place, let us first consider growth driven by imported cases when unchecked. Under a daily flux J ext (T ) of imported cases into the phase A 1 , Eq. (S3) is modified to,Consider a simple situation where the imported cases grow exponentially with a rate \u03bb, i.e. J ext (T ) = J I e \u03bb I (T \u2212T 0 ) . Let's seek an exponentially growing solution where the local population is driven by the imported cases (i.e., the local growth rate in the absence of imported cases is less than \u03bb I ),.In many cases, the ratio of imported and local infections is known. Equation (S51) can then be used to calibrate the level of local transmission when the imported cases grow exponentially at a rate greater than the one given in Supplementary Table 2 for local outbreaks.We consider here a situation where the disease transmission rate per infected individual in a given community gradually weakens according to the schedule,Here T i is the starting date of the intervention and \u03c4 is the duration of the crossover period. For T < T i and T > T i + \u03c4 , \u03b7(T ) is equal to 1 and \u03b7 1 , respectively. For sufficiently slow variation of \u03b7(T ), i.e., \u03c4 is significantly greater than the width of the infectiousness peak which lasts for 2-3 days, we may take the \"adiabatic approximation\" R E (T ) \u03b7(T )R 0 . Equation (S2) then takes the form, The situation represented by blue and red curves is initially driven by imported cases whose number grows exponentially at a rate \u03bb 0 = 0.2/day prior to the lockdown, with an amplitude that decreases linearly and vanishes on the 10th day after the lockdown. No imported cases were introduced to generate the black curve. Taken at face value, our model can reproduce fast or slow crossovers seen in the data from various provinces of China. On the scale of tens of millions of people, Eq. (S52) can only be considered as representing an aggregated trend helped by the linear nature of the model. As the epidemic spreads into disparate communities, there could be huge variations in the level of transmission from community to community, particularly as the policies tighten. Occasional outbreaks are evident from the scattered data in the declining phase of the pandemic.The situation on the cruise ship Diamond Princess is close to a sudden complete confinement of the passengers. Such a scenario is described by the schedule functionUnder the Markovian approximations introduced in Sec. 3.2, the change over from exponential growth to exponential decay can be solved analytically. Take A 1 (T ) = A 0 e \u03bb 0 (T \u2212T i ) for T < T i , we may rewrite Eq. (S52) as,wherePerforming the Laplace transform of Eq. (S53) withwhereSUnder the Markov approximation Eq. (S43), we hav\u1ebdConsequently,\u00c3Carrying out the inverse Laplace transform of Eq. (S55), we obtainHere,Note thatr(\u03bb 0 ) = 1 according to Eq. (S10). Figure 6 , where we assumed the \"daily confirmed\" cases to be proportional to A 1 (T ). Note that the duration of the crossover is set by \u03b1 \u22121 L 3 days for the parameters chosen. At \u03b7 1 = 1 (no homestay order), we have \u03bb + = \u03bb 0 and B + = 1, as can be verified from the expressions given above. The reported COVID-19 infection cases in various countries and regions typically show exponential growth with time during the initial outbreak of the disease. The growth rate \u03bb is of great interest not only to epidemiologists, but also to the general public. In theory, \u03bb can be determined by fitting the cumulative number of confirmed cases to an exponential function of time (days). However, when the number of cases is small, growth tends to be affected by chance events (e.g., super-spreaders) and also by family cases where the transmission pattern can be quite different from that of typical social contacts. Furthermore, it may be dominated by imported cases which do not reflect much of the spreading characteristics in the local community. Therefore caution is required in using the data to extract the epidemic growth rate which itself may vary with time due to the mitigation and intervention measures introduced.In their study of epidemic data for dengue fever in Brazil, Favier et al. [29] proposed to plot the daily new cases \u2206N against the cumulative confirmed cases N (T ) and to fit the data with a linear function to determine \u03bb. For perfect exponential growth, we havewhere \u2206T = 1 day. Therefore the slope of the scatter plot \u2206N (T ) against N (T ) can be used to estimate \u03bb. The next step is to determine the interval over which the fitting is carried out. Following the work by Favier et al., we performed linear fits of \u2206N (T ) against N (T ), each time using one more data point, through which we obtain the slope and goodness-of-fit of these linear regressions as a function of cumulative number of confirmed cases. Then considering the 80th percentile of the slopes left to the minimum goodness-of-fit with goodness-of-fit smaller than 0.5 as the exponential phase, we obtain an estimate of the growth rate. The data and fitted linear functions are shown in Supplementary Figure 7 .In Supplementary Table 10 , we collect the estimated growth rates using the above scheme, along with the statistics of the linear regression (R-squared and p-value for the F-test) and also the total case number in the exponential growth phase for different countries/regions. Where applicable, the estimated values are in good agreement with the location of the plateaus in Main Text Figure 6d . Given the many technical issues involved, we prefer not to include this particular analysis in the Main Text but instead have made revisions to the effect that the epidemic growth rate generally varied from place to place.Solving for \u03bb in Eq. (S57), we obtain,Therefore we may also think of the above procedure as computing the instantaneous growth rates from the ln N (T ) against T curve, with \u2206T chosen suitably to minimize irregularities in testing and reporting. Given the mean incubation period of about 6 days for COVID-19, \u03bb(T ) is expected to be a slow-varying quantity with a typical timescale of a week or longer. Five examples of \u03bb(T ) versus N (T ) during the initial local outbreaks are given in Main Text Figure  6d of the Main Text. Reasonably good agreement is seen between the plateau value of \u03bb(T ) and the growth rates listed in Supplementary Table 10 in four of the five countries, with the exception of Italy, where the substantially lower value of 0.26/day in the table corresponds to the second plateau shown in Main Text Figure 6d . Provincial epidemic growth in China after the Wuhan lockdown has a large component of imported cases. The epidemic development in the Hubei province, on the other hand, is subject to swift intervention and containment measures such as isolation of patients in Fangcang hospitals [30] . The situation in South Korea is also special due to a well-documented outbreak in Daegu in the second half of February [31] . Therefore the growth rates listed in Supplementary Table 10 in these locations need to be interpreted differently. Table 10 : Estimated exponential growth rate \u03bb, linear regression statistics (coefficient of determination R 2 and p-value for the one-sided F -test), and total case number in exponential growth phase since January 23, 2020 for different countries/regions, following the scheme of Favier et al. [29] . The calculated mean reproduction number R E is also shown (95% confidence interval shown in parentheses).",
    "metadata": {
        "paper_id": "278b5dd0acd9235d3d8a8e60178658786c29f996",
        "title": "Supplementary Information Harnessing peak transmission around symptom onset for non-pharmaceutical intervention and containment of the COVID-19 pandemic"
    }
}